%example for how to use compute_planetary_motion(...)
function test_planetary_motion()
    orbit_params = struct();
    orbit_params.m_sun = 1;
    orbit_params.m_planet = 1;
    orbit_params.G = 40;
    x0 = 8;
    y0 = 0;
    dxdt0 = 0;
    dydt0 = 1.5;
    
    V0 = [x0;y0;dxdt0;dydt0];
    t_range = linspace(0,30,100);
    V_list = compute_planetary_motion(t_range,V0,orbit_params);

    tspan = [t_range(1),t_range(end)];
    h_ref = 0.2;
    wrapper = @(t,V) gravity_rate_func(t,V,orbit_params);

    axis equal; axis square;
    axis([-3,9,-6,6])
    hold on
    plot(0,0,'ro','markerfacecolor','r','MarkerSize',5, "DisplayName","sun");
    plot(V_list(:,1),V_list(:,2),'b','MarkerSize',3, "DisplayName","analytical");

    names = {"midpoint","kutta3rd","nystrom5th"};
    for i=1:length(names)
        BT_struct = rk_method(names{i});
        [t_list,X_list,h_avg, num_evals] = explicit_RK_fixed_step_integration(wrapper,tspan,V0,h_ref,BT_struct);
        plot(X_list(1:4:end,1),X_list(1:4:end,2),'--','LineWidth', 1,"DisplayName",names{i});
    end
    legend();    
end